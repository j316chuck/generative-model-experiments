training vae model.
number of parameters -- 2016638.
model args:
**************************************************
save_epochs -- 50
model_type -- vae
base_log -- logs/gfp/vae/
name -- vae_default_medium
input -- 4998
hidden_size -- 200
latent_dim -- 20
seq_length -- 238
pseudo_count -- 1
n_jobs -- 1
device -- cpu
learning_rate -- 0.001
epochs -- 100
batch_size -- 10
layers -- 1
dataset -- gfp
num_data -- 1000
all_characters -- *ACDEFGHIKLMNPQRSTVWY
early_stopping -- <early_stopping.EarlyStopping object at 0x11a7dcba8>
patience -- 10
num_characters -- 21
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
train_loss_history -- []
valid_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 110.2174. train cross entropy loss: 84.5929. train kld loss: 25.6245
time: 2.99 sec. valid loss: 37.5721. valid cross entropy loss: 26.9510, valid kld loss 10.6211
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 35.8648. train cross entropy loss: 27.1015. train kld loss: 8.7633
time: 6.21 sec. valid loss: 36.3772. valid cross entropy loss: 30.4495, valid kld loss 5.9277
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 35.0616. train cross entropy loss: 27.1447. train kld loss: 7.9169
time: 9.30 sec. valid loss: 33.6622. valid cross entropy loss: 26.7430, valid kld loss 6.9192
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 33.1848. train cross entropy loss: 26.5062. train kld loss: 6.6786
time: 12.27 sec. valid loss: 34.8805. valid cross entropy loss: 27.8577, valid kld loss 7.0229
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 31.9499. train cross entropy loss: 26.0306. train kld loss: 5.9193
time: 15.23 sec. valid loss: 32.2301. valid cross entropy loss: 27.3493, valid kld loss 4.8808
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 31.5124. train cross entropy loss: 26.0728. train kld loss: 5.4396
time: 18.23 sec. valid loss: 33.4799. valid cross entropy loss: 29.5495, valid kld loss 3.9304
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 31.1713. train cross entropy loss: 25.7939. train kld loss: 5.3775
time: 21.17 sec. valid loss: 31.6126. valid cross entropy loss: 26.3560, valid kld loss 5.2566
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 29.5650. train cross entropy loss: 25.4623. train kld loss: 4.1027
time: 24.63 sec. valid loss: 30.7735. valid cross entropy loss: 26.0799, valid kld loss 4.6936
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 29.1815. train cross entropy loss: 24.9469. train kld loss: 4.2345
time: 27.69 sec. valid loss: 29.4864. valid cross entropy loss: 26.0576, valid kld loss 3.4289
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 28.0490. train cross entropy loss: 24.7616. train kld loss: 3.2875
time: 31.26 sec. valid loss: 29.0033. valid cross entropy loss: 25.6327, valid kld loss 3.3705
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 27.3967. train cross entropy loss: 24.4175. train kld loss: 2.9793
time: 35.06 sec. valid loss: 28.3976. valid cross entropy loss: 26.2922, valid kld loss 2.1054
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 27.6328. train cross entropy loss: 24.7159. train kld loss: 2.9169
time: 38.04 sec. valid loss: 28.3902. valid cross entropy loss: 25.4102, valid kld loss 2.9799
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 27.1435. train cross entropy loss: 24.2521. train kld loss: 2.8914
time: 41.07 sec. valid loss: 27.2639. valid cross entropy loss: 25.5224, valid kld loss 1.7414
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 25.3384. train cross entropy loss: 23.8730. train kld loss: 1.4654
time: 44.22 sec. valid loss: 26.4067. valid cross entropy loss: 25.2513, valid kld loss 1.1554
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 24.7734. train cross entropy loss: 23.6586. train kld loss: 1.1149
time: 47.27 sec. valid loss: 25.8825. valid cross entropy loss: 24.9024, valid kld loss 0.9801
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 24.1143. train cross entropy loss: 23.3496. train kld loss: 0.7647
time: 50.28 sec. valid loss: 25.4261. valid cross entropy loss: 24.8734, valid kld loss 0.5527
--------------------------------------------------
--------------------------------------------------
epoch: 17. train loss: 23.7128. train cross entropy loss: 23.2946. train kld loss: 0.4181
time: 53.48 sec. valid loss: 24.9788. valid cross entropy loss: 24.6496, valid kld loss 0.3292
--------------------------------------------------
--------------------------------------------------
epoch: 18. train loss: 23.5072. train cross entropy loss: 23.2426. train kld loss: 0.2646
time: 56.76 sec. valid loss: 24.7665. valid cross entropy loss: 24.6562, valid kld loss 0.1103
--------------------------------------------------
--------------------------------------------------
epoch: 19. train loss: 23.2741. train cross entropy loss: 23.0845. train kld loss: 0.1896
time: 60.07 sec. valid loss: 24.8082. valid cross entropy loss: 24.6883, valid kld loss 0.1199
--------------------------------------------------
--------------------------------------------------
epoch: 20. train loss: 23.1843. train cross entropy loss: 22.9756. train kld loss: 0.2087
time: 63.05 sec. valid loss: 24.8159. valid cross entropy loss: 24.6737, valid kld loss 0.1422
--------------------------------------------------
--------------------------------------------------
epoch: 21. train loss: 23.0814. train cross entropy loss: 22.8367. train kld loss: 0.2447
time: 66.03 sec. valid loss: 24.8236. valid cross entropy loss: 24.6747, valid kld loss 0.1489
--------------------------------------------------
--------------------------------------------------
epoch: 22. train loss: 23.1616. train cross entropy loss: 22.8542. train kld loss: 0.3074
time: 68.98 sec. valid loss: 24.7425. valid cross entropy loss: 24.5669, valid kld loss 0.1756
--------------------------------------------------
--------------------------------------------------
epoch: 23. train loss: 22.9983. train cross entropy loss: 22.6247. train kld loss: 0.3737
time: 71.94 sec. valid loss: 24.8922. valid cross entropy loss: 24.6808, valid kld loss 0.2115
--------------------------------------------------
--------------------------------------------------
epoch: 24. train loss: 22.9457. train cross entropy loss: 22.5058. train kld loss: 0.4398
time: 74.89 sec. valid loss: 24.9077. valid cross entropy loss: 24.6633, valid kld loss 0.2445
--------------------------------------------------
--------------------------------------------------
epoch: 25. train loss: 22.9539. train cross entropy loss: 22.4083. train kld loss: 0.5456
time: 77.81 sec. valid loss: 24.9327. valid cross entropy loss: 24.6240, valid kld loss 0.3087
--------------------------------------------------
--------------------------------------------------
epoch: 26. train loss: 22.7340. train cross entropy loss: 22.0696. train kld loss: 0.6643
time: 80.81 sec. valid loss: 25.0619. valid cross entropy loss: 24.6788, valid kld loss 0.3831
--------------------------------------------------
--------------------------------------------------
epoch: 27. train loss: 22.6352. train cross entropy loss: 21.8420. train kld loss: 0.7932
time: 83.74 sec. valid loss: 25.0219. valid cross entropy loss: 24.5649, valid kld loss 0.4570
--------------------------------------------------
--------------------------------------------------
epoch: 28. train loss: 22.6330. train cross entropy loss: 21.6765. train kld loss: 0.9566
time: 86.74 sec. valid loss: 25.1345. valid cross entropy loss: 24.6411, valid kld loss 0.4934
--------------------------------------------------
--------------------------------------------------
epoch: 29. train loss: 22.4692. train cross entropy loss: 21.3617. train kld loss: 1.1074
time: 89.70 sec. valid loss: 25.2441. valid cross entropy loss: 24.6002, valid kld loss 0.6439
--------------------------------------------------
--------------------------------------------------
epoch: 30. train loss: 22.3191. train cross entropy loss: 21.0247. train kld loss: 1.2944
time: 92.60 sec. valid loss: 25.2377. valid cross entropy loss: 24.5656, valid kld loss 0.6721
--------------------------------------------------
--------------------------------------------------
epoch: 31. train loss: 22.1351. train cross entropy loss: 20.6542. train kld loss: 1.4809
time: 95.55 sec. valid loss: 25.5786. valid cross entropy loss: 24.6585, valid kld loss 0.9201
--------------------------------------------------
--------------------------------------------------
epoch: 32. train loss: 22.3607. train cross entropy loss: 20.6295. train kld loss: 1.7312
time: 98.53 sec. valid loss: 25.5800. valid cross entropy loss: 24.5903, valid kld loss 0.9896
--------------------------------------------------
--------------------------------------------------
early stopped at epoch 32
loading model from epoch 22
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 25.1890 cross entropy loss: 25.0167. kld loss: 0.1723
**************************************************
average mismatches per sample: 3.6530
**************************************************
{'exit_code': 0, 'train_score': (22.592653274536133, 22.261831283569336, 0.3308192789554596), 'valid_score': (24.864917755126953, 24.689311981201172, 0.17560718953609467), 'test_score': (25.18901824951172, 25.016695022583008, 0.17232130467891693), 'average_mismatches': 3.653, 'num_params': 2016638, 'total_time': 104.26331520080566}
