Training vae_learning_rate_0.003_hidden_size_200_batch_size_10 
Args:
args -- {'model_type': 'vae', 'base_log': './logs/vae_small_optimization/', 'name': 'vae_learning_rate_0.003_hidden_size_200_batch_size_10', 'input': 4998, 'hidden_size': 200, 'latent_dim': 20, 'seq_length': 238, 'pseudo_count': 1, 'n_jobs': 5, 'learning_rate': 0.003, 'epochs': 50, 'batch_size': 10, 'layers': 2, 'dataset': 'gfp_amino_acid', 'num_data': 1000, 'device': device(type='cpu'), 'vocabulary': '*ACDEFGHIKLMNPQRSTVWY', 'wild_type': 'SKGEELFTGVVPILVELDGDVNGHKFSVSGEGEGDATYGKLTLKFICTTGKLPVPWPTLVTTLSYGVQCFSRYPDHMKQHDFFKSAMPEGYVQERTIFFKDDGNYKTRAEVKFEGDTLVNRIELKGIDFKEDGNILGHKLEYNYNSHNVYIMADKQKNGIKVNFKIRHNIEDGSVQLADHYQQNTPIGDGPVLLPDNHYLSTQSALSKDPNEKRDHMVLLEFVTAAGITHGMDELYK*'}
save_epochs -- 50
model_type -- vae
name -- vae_learning_rate_0.003_hidden_size_200_batch_size_10
input -- 4998
hidden_size -- 200
latent_dim -- 20
device -- cpu
learning_rate -- 0.003
epochs -- 50
all_characters -- *ACDEFGHIKLMNPQRSTVWY
seq_length -- 238
batch_size -- 10
num_characters -- 21
character_to_int -- {'*': 0, 'A': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'H': 7, 'I': 8, 'K': 9, 'L': 10, 'M': 11, 'N': 12, 'P': 13, 'Q': 14, 'R': 15, 'S': 16, 'T': 17, 'V': 18, 'W': 19, 'Y': 20}
int_to_character -- {0: '*', 1: 'A', 2: 'C', 3: 'D', 4: 'E', 5: 'F', 6: 'G', 7: 'H', 8: 'I', 9: 'K', 10: 'L', 11: 'M', 12: 'N', 13: 'P', 14: 'Q', 15: 'R', 16: 'S', 17: 'T', 18: 'V', 19: 'W', 20: 'Y'}
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
model -- VAE(
  (fc1): Linear(in_features=4998, out_features=200, bias=True)
  (fc21): Linear(in_features=200, out_features=20, bias=True)
  (fc22): Linear(in_features=200, out_features=20, bias=True)
  (fc3): Linear(in_features=20, out_features=200, bias=True)
  (fc4): Linear(in_features=200, out_features=4998, bias=True)
)
optimizer -- Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.003
    weight_decay: 0
)
train_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 69.4657. train cross entropy loss: 54.1622. train kld loss: 15.3035
time: 2.90 sec. valid loss: 33.2958. valid cross entropy loss: 28.1824, valid kld loss 5.1134
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 32.5768. train cross entropy loss: 26.8296. train kld loss: 5.7472
time: 5.81 sec. valid loss: 31.0952. valid cross entropy loss: 27.9842, valid kld loss 3.1110
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 30.1320. train cross entropy loss: 25.9601. train kld loss: 4.1719
time: 8.75 sec. valid loss: 29.9866. valid cross entropy loss: 25.6534, valid kld loss 4.3331
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 27.5383. train cross entropy loss: 25.1491. train kld loss: 2.3892
time: 11.65 sec. valid loss: 28.0517. valid cross entropy loss: 25.8524, valid kld loss 2.1993
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 26.0957. train cross entropy loss: 24.5229. train kld loss: 1.5728
time: 14.52 sec. valid loss: 26.7198. valid cross entropy loss: 25.5665, valid kld loss 1.1534
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 25.5661. train cross entropy loss: 24.3456. train kld loss: 1.2205
time: 17.39 sec. valid loss: 26.5587. valid cross entropy loss: 25.6317, valid kld loss 0.9270
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 24.9188. train cross entropy loss: 23.9819. train kld loss: 0.9369
time: 20.32 sec. valid loss: 26.2250. valid cross entropy loss: 25.5284, valid kld loss 0.6966
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 24.3729. train cross entropy loss: 23.6296. train kld loss: 0.7432
time: 23.18 sec. valid loss: 26.0337. valid cross entropy loss: 25.5877, valid kld loss 0.4460
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 23.8863. train cross entropy loss: 23.1440. train kld loss: 0.7423
time: 26.04 sec. valid loss: 25.8417. valid cross entropy loss: 25.2809, valid kld loss 0.5608
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 23.7959. train cross entropy loss: 22.8935. train kld loss: 0.9024
time: 28.88 sec. valid loss: 25.7381. valid cross entropy loss: 25.0451, valid kld loss 0.6930
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 23.5853. train cross entropy loss: 22.4128. train kld loss: 1.1725
time: 31.74 sec. valid loss: 25.7725. valid cross entropy loss: 24.9348, valid kld loss 0.8378
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 23.3471. train cross entropy loss: 21.9102. train kld loss: 1.4369
time: 34.58 sec. valid loss: 25.9445. valid cross entropy loss: 25.0975, valid kld loss 0.8470
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 23.2585. train cross entropy loss: 21.5537. train kld loss: 1.7048
time: 37.45 sec. valid loss: 26.3743. valid cross entropy loss: 25.2065, valid kld loss 1.1679
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 23.1500. train cross entropy loss: 21.2052. train kld loss: 1.9449
time: 40.28 sec. valid loss: 26.1888. valid cross entropy loss: 25.0522, valid kld loss 1.1366
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 23.1878. train cross entropy loss: 20.8958. train kld loss: 2.2921
time: 43.22 sec. valid loss: 26.7130. valid cross entropy loss: 24.9949, valid kld loss 1.7180
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 22.9104. train cross entropy loss: 20.3538. train kld loss: 2.5566
time: 46.14 sec. valid loss: 26.5764. valid cross entropy loss: 25.1996, valid kld loss 1.3768
--------------------------------------------------
--------------------------------------------------
epoch: 17. train loss: 22.9147. train cross entropy loss: 20.0565. train kld loss: 2.8581
time: 48.99 sec. valid loss: 26.8143. valid cross entropy loss: 24.8434, valid kld loss 1.9709
--------------------------------------------------
--------------------------------------------------
epoch: 18. train loss: 22.7981. train cross entropy loss: 19.5638. train kld loss: 3.2343
time: 51.83 sec. valid loss: 27.1856. valid cross entropy loss: 25.3424, valid kld loss 1.8432
--------------------------------------------------
--------------------------------------------------
epoch: 19. train loss: 22.6592. train cross entropy loss: 19.3186. train kld loss: 3.3406
time: 54.70 sec. valid loss: 27.4104. valid cross entropy loss: 25.4319, valid kld loss 1.9785
--------------------------------------------------
--------------------------------------------------
epoch: 20. train loss: 22.5445. train cross entropy loss: 18.8189. train kld loss: 3.7257
time: 57.54 sec. valid loss: 27.4187. valid cross entropy loss: 25.5994, valid kld loss 1.8193
--------------------------------------------------
--------------------------------------------------
epoch: 21. train loss: 22.3601. train cross entropy loss: 18.5650. train kld loss: 3.7951
time: 60.40 sec. valid loss: 27.6843. valid cross entropy loss: 25.0991, valid kld loss 2.5853
--------------------------------------------------
--------------------------------------------------
epoch: 22. train loss: 22.2390. train cross entropy loss: 18.1785. train kld loss: 4.0605
time: 63.33 sec. valid loss: 27.5834. valid cross entropy loss: 25.3794, valid kld loss 2.2040
--------------------------------------------------
--------------------------------------------------
epoch: 23. train loss: 22.4107. train cross entropy loss: 17.9961. train kld loss: 4.4147
time: 66.21 sec. valid loss: 28.4725. valid cross entropy loss: 25.7517, valid kld loss 2.7208
--------------------------------------------------
--------------------------------------------------
epoch: 24. train loss: 22.5893. train cross entropy loss: 17.9191. train kld loss: 4.6702
time: 69.08 sec. valid loss: 28.4139. valid cross entropy loss: 25.7073, valid kld loss 2.7065
--------------------------------------------------
--------------------------------------------------
epoch: 25. train loss: 22.2761. train cross entropy loss: 17.5036. train kld loss: 4.7725
time: 71.98 sec. valid loss: 27.9562. valid cross entropy loss: 25.4012, valid kld loss 2.5550
--------------------------------------------------
--------------------------------------------------
epoch: 26. train loss: 22.1768. train cross entropy loss: 17.1583. train kld loss: 5.0185
time: 74.93 sec. valid loss: 28.8619. valid cross entropy loss: 25.8047, valid kld loss 3.0572
--------------------------------------------------
--------------------------------------------------
epoch: 27. train loss: 21.9358. train cross entropy loss: 16.7816. train kld loss: 5.1541
time: 77.86 sec. valid loss: 28.9237. valid cross entropy loss: 26.4251, valid kld loss 2.4986
--------------------------------------------------
--------------------------------------------------
epoch: 28. train loss: 21.9627. train cross entropy loss: 16.7145. train kld loss: 5.2481
time: 80.80 sec. valid loss: 28.7065. valid cross entropy loss: 25.5447, valid kld loss 3.1618
--------------------------------------------------
--------------------------------------------------
epoch: 29. train loss: 21.8698. train cross entropy loss: 16.5072. train kld loss: 5.3627
time: 83.69 sec. valid loss: 28.9919. valid cross entropy loss: 26.8246, valid kld loss 2.1673
--------------------------------------------------
--------------------------------------------------
epoch: 30. train loss: 21.9722. train cross entropy loss: 16.4011. train kld loss: 5.5711
time: 86.57 sec. valid loss: 28.8289. valid cross entropy loss: 25.5274, valid kld loss 3.3015
--------------------------------------------------
--------------------------------------------------
epoch: 31. train loss: 21.6147. train cross entropy loss: 15.8552. train kld loss: 5.7595
time: 89.47 sec. valid loss: 29.2281. valid cross entropy loss: 25.9397, valid kld loss 3.2884
--------------------------------------------------
--------------------------------------------------
epoch: 32. train loss: 21.5651. train cross entropy loss: 15.7893. train kld loss: 5.7758
time: 92.36 sec. valid loss: 29.6590. valid cross entropy loss: 25.8673, valid kld loss 3.7917
--------------------------------------------------
--------------------------------------------------
epoch: 33. train loss: 21.3332. train cross entropy loss: 15.3934. train kld loss: 5.9398
time: 95.21 sec. valid loss: 29.6983. valid cross entropy loss: 26.2423, valid kld loss 3.4560
--------------------------------------------------
--------------------------------------------------
epoch: 34. train loss: 21.6987. train cross entropy loss: 15.5114. train kld loss: 6.1873
time: 98.07 sec. valid loss: 29.4896. valid cross entropy loss: 25.7512, valid kld loss 3.7383
--------------------------------------------------
--------------------------------------------------
epoch: 35. train loss: 21.3417. train cross entropy loss: 15.1325. train kld loss: 6.2092
time: 101.04 sec. valid loss: 30.0194. valid cross entropy loss: 25.9038, valid kld loss 4.1156
--------------------------------------------------
--------------------------------------------------
epoch: 36. train loss: 21.1650. train cross entropy loss: 14.9562. train kld loss: 6.2087
time: 103.94 sec. valid loss: 29.9955. valid cross entropy loss: 26.9459, valid kld loss 3.0496
--------------------------------------------------
--------------------------------------------------
epoch: 37. train loss: 21.1616. train cross entropy loss: 14.7719. train kld loss: 6.3897
time: 106.87 sec. valid loss: 30.0984. valid cross entropy loss: 26.6660, valid kld loss 3.4324
--------------------------------------------------
--------------------------------------------------
epoch: 38. train loss: 21.0862. train cross entropy loss: 14.5598. train kld loss: 6.5264
time: 109.82 sec. valid loss: 29.9707. valid cross entropy loss: 26.2897, valid kld loss 3.6811
--------------------------------------------------
--------------------------------------------------
epoch: 39. train loss: 20.9072. train cross entropy loss: 14.3455. train kld loss: 6.5617
time: 112.85 sec. valid loss: 30.1707. valid cross entropy loss: 26.2085, valid kld loss 3.9622
--------------------------------------------------
--------------------------------------------------
epoch: 40. train loss: 21.4681. train cross entropy loss: 14.4140. train kld loss: 7.0541
time: 115.76 sec. valid loss: 30.8316. valid cross entropy loss: 27.6149, valid kld loss 3.2167
--------------------------------------------------
--------------------------------------------------
epoch: 41. train loss: 20.8384. train cross entropy loss: 14.0088. train kld loss: 6.8297
time: 118.69 sec. valid loss: 31.1709. valid cross entropy loss: 27.2122, valid kld loss 3.9587
--------------------------------------------------
--------------------------------------------------
epoch: 42. train loss: 21.1414. train cross entropy loss: 14.1375. train kld loss: 7.0039
time: 121.58 sec. valid loss: 30.5806. valid cross entropy loss: 26.0852, valid kld loss 4.4954
--------------------------------------------------
--------------------------------------------------
epoch: 43. train loss: 20.8795. train cross entropy loss: 13.8714. train kld loss: 7.0081
time: 124.45 sec. valid loss: 30.6684. valid cross entropy loss: 25.9416, valid kld loss 4.7268
--------------------------------------------------
--------------------------------------------------
epoch: 44. train loss: 20.7412. train cross entropy loss: 13.5635. train kld loss: 7.1777
time: 127.35 sec. valid loss: 30.3373. valid cross entropy loss: 26.2828, valid kld loss 4.0545
--------------------------------------------------
--------------------------------------------------
epoch: 45. train loss: 20.7903. train cross entropy loss: 13.6058. train kld loss: 7.1845
time: 130.35 sec. valid loss: 31.2824. valid cross entropy loss: 27.8094, valid kld loss 3.4730
--------------------------------------------------
--------------------------------------------------
epoch: 46. train loss: 21.1144. train cross entropy loss: 13.6730. train kld loss: 7.4413
time: 133.27 sec. valid loss: 31.2180. valid cross entropy loss: 26.8325, valid kld loss 4.3855
--------------------------------------------------
--------------------------------------------------
epoch: 47. train loss: 20.6418. train cross entropy loss: 13.2976. train kld loss: 7.3443
time: 136.24 sec. valid loss: 31.6113. valid cross entropy loss: 27.3437, valid kld loss 4.2677
--------------------------------------------------
--------------------------------------------------
epoch: 48. train loss: 20.7284. train cross entropy loss: 13.1663. train kld loss: 7.5621
time: 139.18 sec. valid loss: 31.0209. valid cross entropy loss: 27.1083, valid kld loss 3.9126
--------------------------------------------------
--------------------------------------------------
epoch: 49. train loss: 20.6919. train cross entropy loss: 13.1528. train kld loss: 7.5391
time: 142.15 sec. valid loss: 31.9976. valid cross entropy loss: 28.0035, valid kld loss 3.9941
--------------------------------------------------
--------------------------------------------------
epoch: 50. train loss: 20.8055. train cross entropy loss: 12.9215. train kld loss: 7.8840
time: 145.05 sec. valid loss: 31.4244. valid cross entropy loss: 26.9909, valid kld loss 4.4335
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 31.6837 cross entropy loss: 27.1792. kld loss: 4.5044
