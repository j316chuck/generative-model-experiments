Training vae_learning_rate_0.001_hidden_size_200_batch_size_20 
Args:
args -- {'model_type': 'vae', 'base_log': './logs/vae_small_optimization/', 'name': 'vae_learning_rate_0.001_hidden_size_200_batch_size_20', 'input': 4998, 'hidden_size': 200, 'latent_dim': 20, 'seq_length': 238, 'pseudo_count': 1, 'n_jobs': 5, 'learning_rate': 0.001, 'epochs': 50, 'batch_size': 20, 'layers': 2, 'dataset': 'gfp_amino_acid', 'num_data': 1000, 'device': device(type='cpu'), 'vocabulary': '*ACDEFGHIKLMNPQRSTVWY', 'wild_type': 'SKGEELFTGVVPILVELDGDVNGHKFSVSGEGEGDATYGKLTLKFICTTGKLPVPWPTLVTTLSYGVQCFSRYPDHMKQHDFFKSAMPEGYVQERTIFFKDDGNYKTRAEVKFEGDTLVNRIELKGIDFKEDGNILGHKLEYNYNSHNVYIMADKQKNGIKVNFKIRHNIEDGSVQLADHYQQNTPIGDGPVLLPDNHYLSTQSALSKDPNEKRDHMVLLEFVTAAGITHGMDELYK*'}
save_epochs -- 50
model_type -- vae
name -- vae_learning_rate_0.001_hidden_size_200_batch_size_20
input -- 4998
hidden_size -- 200
latent_dim -- 20
device -- cpu
learning_rate -- 0.001
epochs -- 50
all_characters -- *ACDEFGHIKLMNPQRSTVWY
seq_length -- 238
batch_size -- 20
num_characters -- 21
character_to_int -- {'*': 0, 'A': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'H': 7, 'I': 8, 'K': 9, 'L': 10, 'M': 11, 'N': 12, 'P': 13, 'Q': 14, 'R': 15, 'S': 16, 'T': 17, 'V': 18, 'W': 19, 'Y': 20}
int_to_character -- {0: '*', 1: 'A', 2: 'C', 3: 'D', 4: 'E', 5: 'F', 6: 'G', 7: 'H', 8: 'I', 9: 'K', 10: 'L', 11: 'M', 12: 'N', 13: 'P', 14: 'Q', 15: 'R', 16: 'S', 17: 'T', 18: 'V', 19: 'W', 20: 'Y'}
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
model -- VAE(
  (fc1): Linear(in_features=4998, out_features=200, bias=True)
  (fc21): Linear(in_features=200, out_features=20, bias=True)
  (fc22): Linear(in_features=200, out_features=20, bias=True)
  (fc3): Linear(in_features=20, out_features=200, bias=True)
  (fc4): Linear(in_features=200, out_features=4998, bias=True)
)
optimizer -- Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0
)
train_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 174.7003. train cross entropy loss: 134.8392. train kld loss: 39.8610
time: 1.65 sec. valid loss: 42.4786. valid cross entropy loss: 30.6412, valid kld loss 11.8374
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 38.6053. train cross entropy loss: 27.4232. train kld loss: 11.1821
time: 3.46 sec. valid loss: 36.8890. valid cross entropy loss: 26.9123, valid kld loss 9.9767
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 35.3984. train cross entropy loss: 26.6698. train kld loss: 8.7286
time: 5.28 sec. valid loss: 35.6611. valid cross entropy loss: 26.4218, valid kld loss 9.2393
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 33.5062. train cross entropy loss: 25.8988. train kld loss: 7.6074
time: 7.13 sec. valid loss: 34.2393. valid cross entropy loss: 27.1880, valid kld loss 7.0513
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 32.5365. train cross entropy loss: 25.7977. train kld loss: 6.7388
time: 8.97 sec. valid loss: 34.0370. valid cross entropy loss: 28.9291, valid kld loss 5.1079
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 31.7492. train cross entropy loss: 25.6180. train kld loss: 6.1312
time: 10.81 sec. valid loss: 33.1927. valid cross entropy loss: 27.5812, valid kld loss 5.6115
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 33.0589. train cross entropy loss: 26.1186. train kld loss: 6.9403
time: 12.63 sec. valid loss: 32.9349. valid cross entropy loss: 26.5148, valid kld loss 6.4201
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 30.8555. train cross entropy loss: 25.3264. train kld loss: 5.5291
time: 14.47 sec. valid loss: 32.1154. valid cross entropy loss: 26.4474, valid kld loss 5.6680
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 30.5598. train cross entropy loss: 25.2130. train kld loss: 5.3468
time: 16.31 sec. valid loss: 32.0237. valid cross entropy loss: 26.5939, valid kld loss 5.4299
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 30.0811. train cross entropy loss: 25.1375. train kld loss: 4.9436
time: 18.15 sec. valid loss: 32.0887. valid cross entropy loss: 27.0708, valid kld loss 5.0180
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 29.8206. train cross entropy loss: 25.2080. train kld loss: 4.6127
time: 19.98 sec. valid loss: 32.5328. valid cross entropy loss: 26.6492, valid kld loss 5.8835
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 29.7430. train cross entropy loss: 24.8726. train kld loss: 4.8704
time: 21.80 sec. valid loss: 30.6238. valid cross entropy loss: 26.6203, valid kld loss 4.0035
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 28.8621. train cross entropy loss: 24.6744. train kld loss: 4.1877
time: 23.62 sec. valid loss: 30.7075. valid cross entropy loss: 26.3897, valid kld loss 4.3178
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 28.5093. train cross entropy loss: 24.5155. train kld loss: 3.9938
time: 25.44 sec. valid loss: 30.1479. valid cross entropy loss: 26.9482, valid kld loss 3.1997
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 28.4562. train cross entropy loss: 24.5780. train kld loss: 3.8783
time: 27.28 sec. valid loss: 30.6068. valid cross entropy loss: 27.5716, valid kld loss 3.0353
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 28.3971. train cross entropy loss: 24.5334. train kld loss: 3.8638
time: 29.13 sec. valid loss: 29.9977. valid cross entropy loss: 26.6853, valid kld loss 3.3125
--------------------------------------------------
--------------------------------------------------
epoch: 17. train loss: 27.8773. train cross entropy loss: 24.3434. train kld loss: 3.5339
time: 30.94 sec. valid loss: 29.3583. valid cross entropy loss: 26.5925, valid kld loss 2.7658
--------------------------------------------------
--------------------------------------------------
epoch: 18. train loss: 27.5119. train cross entropy loss: 24.2146. train kld loss: 3.2973
time: 32.77 sec. valid loss: 28.8644. valid cross entropy loss: 26.1262, valid kld loss 2.7382
--------------------------------------------------
--------------------------------------------------
epoch: 19. train loss: 27.1869. train cross entropy loss: 24.0757. train kld loss: 3.1112
time: 34.60 sec. valid loss: 28.7479. valid cross entropy loss: 25.6102, valid kld loss 3.1377
--------------------------------------------------
--------------------------------------------------
epoch: 20. train loss: 26.8075. train cross entropy loss: 23.9407. train kld loss: 2.8669
time: 36.43 sec. valid loss: 28.4434. valid cross entropy loss: 26.0726, valid kld loss 2.3708
--------------------------------------------------
--------------------------------------------------
epoch: 21. train loss: 26.4617. train cross entropy loss: 23.7995. train kld loss: 2.6622
time: 38.28 sec. valid loss: 28.6108. valid cross entropy loss: 25.7516, valid kld loss 2.8591
--------------------------------------------------
--------------------------------------------------
epoch: 22. train loss: 26.0448. train cross entropy loss: 23.7334. train kld loss: 2.3114
time: 40.18 sec. valid loss: 28.7333. valid cross entropy loss: 26.9546, valid kld loss 1.7787
--------------------------------------------------
--------------------------------------------------
epoch: 23. train loss: 28.1382. train cross entropy loss: 24.2499. train kld loss: 3.8883
time: 41.99 sec. valid loss: 28.8183. valid cross entropy loss: 27.3277, valid kld loss 1.4905
--------------------------------------------------
--------------------------------------------------
epoch: 24. train loss: 25.6709. train cross entropy loss: 23.8096. train kld loss: 1.8613
time: 43.83 sec. valid loss: 27.0711. valid cross entropy loss: 25.6350, valid kld loss 1.4361
--------------------------------------------------
--------------------------------------------------
epoch: 25. train loss: 25.2943. train cross entropy loss: 23.4815. train kld loss: 1.8128
time: 45.70 sec. valid loss: 27.0260. valid cross entropy loss: 25.5589, valid kld loss 1.4670
--------------------------------------------------
--------------------------------------------------
epoch: 26. train loss: 25.5309. train cross entropy loss: 23.4844. train kld loss: 2.0465
time: 47.53 sec. valid loss: 26.8666. valid cross entropy loss: 25.6711, valid kld loss 1.1955
--------------------------------------------------
--------------------------------------------------
epoch: 27. train loss: 24.6862. train cross entropy loss: 23.3613. train kld loss: 1.3250
time: 49.36 sec. valid loss: 26.4610. valid cross entropy loss: 25.2870, valid kld loss 1.1740
--------------------------------------------------
--------------------------------------------------
epoch: 28. train loss: 24.4093. train cross entropy loss: 23.2824. train kld loss: 1.1269
time: 51.18 sec. valid loss: 26.4634. valid cross entropy loss: 25.3382, valid kld loss 1.1252
--------------------------------------------------
--------------------------------------------------
epoch: 29. train loss: 24.1242. train cross entropy loss: 23.0856. train kld loss: 1.0385
time: 53.03 sec. valid loss: 26.1539. valid cross entropy loss: 25.3762, valid kld loss 0.7777
--------------------------------------------------
--------------------------------------------------
epoch: 30. train loss: 23.8829. train cross entropy loss: 23.0728. train kld loss: 0.8101
time: 54.87 sec. valid loss: 25.9371. valid cross entropy loss: 24.9982, valid kld loss 0.9389
--------------------------------------------------
--------------------------------------------------
epoch: 31. train loss: 23.6953. train cross entropy loss: 22.9261. train kld loss: 0.7692
time: 56.69 sec. valid loss: 25.6953. valid cross entropy loss: 25.2123, valid kld loss 0.4829
--------------------------------------------------
--------------------------------------------------
epoch: 32. train loss: 23.4840. train cross entropy loss: 22.8376. train kld loss: 0.6464
time: 58.50 sec. valid loss: 25.5146. valid cross entropy loss: 25.1438, valid kld loss 0.3709
--------------------------------------------------
--------------------------------------------------
epoch: 33. train loss: 23.3752. train cross entropy loss: 22.8583. train kld loss: 0.5169
time: 60.31 sec. valid loss: 25.3253. valid cross entropy loss: 25.0172, valid kld loss 0.3080
--------------------------------------------------
--------------------------------------------------
epoch: 34. train loss: 23.0659. train cross entropy loss: 22.6759. train kld loss: 0.3900
time: 62.16 sec. valid loss: 25.1858. valid cross entropy loss: 24.9184, valid kld loss 0.2674
--------------------------------------------------
--------------------------------------------------
epoch: 35. train loss: 22.9543. train cross entropy loss: 22.5916. train kld loss: 0.3627
time: 64.00 sec. valid loss: 25.1677. valid cross entropy loss: 24.9790, valid kld loss 0.1887
--------------------------------------------------
--------------------------------------------------
epoch: 36. train loss: 22.8884. train cross entropy loss: 22.5350. train kld loss: 0.3534
time: 65.78 sec. valid loss: 25.0510. valid cross entropy loss: 24.8586, valid kld loss 0.1924
--------------------------------------------------
--------------------------------------------------
epoch: 37. train loss: 22.8749. train cross entropy loss: 22.4880. train kld loss: 0.3870
time: 67.62 sec. valid loss: 25.0729. valid cross entropy loss: 24.8258, valid kld loss 0.2472
--------------------------------------------------
--------------------------------------------------
epoch: 38. train loss: 22.7573. train cross entropy loss: 22.3299. train kld loss: 0.4274
time: 69.44 sec. valid loss: 25.1606. valid cross entropy loss: 24.9328, valid kld loss 0.2278
--------------------------------------------------
--------------------------------------------------
epoch: 39. train loss: 22.6175. train cross entropy loss: 22.1513. train kld loss: 0.4662
time: 71.28 sec. valid loss: 25.0840. valid cross entropy loss: 24.8407, valid kld loss 0.2433
--------------------------------------------------
--------------------------------------------------
epoch: 40. train loss: 22.6212. train cross entropy loss: 22.0926. train kld loss: 0.5286
time: 73.14 sec. valid loss: 25.0989. valid cross entropy loss: 24.8211, valid kld loss 0.2778
--------------------------------------------------
--------------------------------------------------
epoch: 41. train loss: 22.6055. train cross entropy loss: 22.0145. train kld loss: 0.5909
time: 74.96 sec. valid loss: 25.1184. valid cross entropy loss: 24.8276, valid kld loss 0.2908
--------------------------------------------------
--------------------------------------------------
epoch: 42. train loss: 22.5688. train cross entropy loss: 21.8899. train kld loss: 0.6789
time: 76.78 sec. valid loss: 25.1553. valid cross entropy loss: 24.8173, valid kld loss 0.3380
--------------------------------------------------
--------------------------------------------------
epoch: 43. train loss: 22.5250. train cross entropy loss: 21.7829. train kld loss: 0.7421
time: 78.61 sec. valid loss: 25.1379. valid cross entropy loss: 24.7593, valid kld loss 0.3786
--------------------------------------------------
--------------------------------------------------
epoch: 44. train loss: 22.4216. train cross entropy loss: 21.5882. train kld loss: 0.8334
time: 80.42 sec. valid loss: 25.1599. valid cross entropy loss: 24.7449, valid kld loss 0.4151
--------------------------------------------------
--------------------------------------------------
epoch: 45. train loss: 22.3496. train cross entropy loss: 21.4089. train kld loss: 0.9407
time: 82.24 sec. valid loss: 25.3931. valid cross entropy loss: 24.8824, valid kld loss 0.5107
--------------------------------------------------
--------------------------------------------------
epoch: 46. train loss: 22.2794. train cross entropy loss: 21.2551. train kld loss: 1.0242
time: 84.07 sec. valid loss: 25.3421. valid cross entropy loss: 24.8530, valid kld loss 0.4890
--------------------------------------------------
--------------------------------------------------
epoch: 47. train loss: 21.9653. train cross entropy loss: 20.8690. train kld loss: 1.0964
time: 85.89 sec. valid loss: 25.4149. valid cross entropy loss: 24.9024, valid kld loss 0.5125
--------------------------------------------------
--------------------------------------------------
epoch: 48. train loss: 22.1372. train cross entropy loss: 20.9318. train kld loss: 1.2054
time: 87.72 sec. valid loss: 25.3369. valid cross entropy loss: 24.7309, valid kld loss 0.6060
--------------------------------------------------
--------------------------------------------------
epoch: 49. train loss: 22.0934. train cross entropy loss: 20.7451. train kld loss: 1.3483
time: 89.56 sec. valid loss: 25.4262. valid cross entropy loss: 24.7598, valid kld loss 0.6664
--------------------------------------------------
--------------------------------------------------
epoch: 50. train loss: 22.0444. train cross entropy loss: 20.5455. train kld loss: 1.4989
time: 91.38 sec. valid loss: 25.5142. valid cross entropy loss: 24.8077, valid kld loss 0.7065
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 25.8909 cross entropy loss: 25.1828. kld loss: 0.7082
