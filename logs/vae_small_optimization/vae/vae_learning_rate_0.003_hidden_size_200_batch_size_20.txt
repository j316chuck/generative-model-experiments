Training vae_learning_rate_0.003_hidden_size_200_batch_size_20 
Args:
args -- {'model_type': 'vae', 'base_log': './logs/vae_small_optimization/', 'name': 'vae_learning_rate_0.003_hidden_size_200_batch_size_20', 'input': 4998, 'hidden_size': 200, 'latent_dim': 20, 'seq_length': 238, 'pseudo_count': 1, 'n_jobs': 5, 'learning_rate': 0.003, 'epochs': 50, 'batch_size': 20, 'layers': 2, 'dataset': 'gfp_amino_acid', 'num_data': 1000, 'device': device(type='cpu'), 'vocabulary': '*ACDEFGHIKLMNPQRSTVWY', 'wild_type': 'SKGEELFTGVVPILVELDGDVNGHKFSVSGEGEGDATYGKLTLKFICTTGKLPVPWPTLVTTLSYGVQCFSRYPDHMKQHDFFKSAMPEGYVQERTIFFKDDGNYKTRAEVKFEGDTLVNRIELKGIDFKEDGNILGHKLEYNYNSHNVYIMADKQKNGIKVNFKIRHNIEDGSVQLADHYQQNTPIGDGPVLLPDNHYLSTQSALSKDPNEKRDHMVLLEFVTAAGITHGMDELYK*'}
save_epochs -- 50
model_type -- vae
name -- vae_learning_rate_0.003_hidden_size_200_batch_size_20
input -- 4998
hidden_size -- 200
latent_dim -- 20
device -- cpu
learning_rate -- 0.003
epochs -- 50
all_characters -- *ACDEFGHIKLMNPQRSTVWY
seq_length -- 238
batch_size -- 20
num_characters -- 21
character_to_int -- {'*': 0, 'A': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'H': 7, 'I': 8, 'K': 9, 'L': 10, 'M': 11, 'N': 12, 'P': 13, 'Q': 14, 'R': 15, 'S': 16, 'T': 17, 'V': 18, 'W': 19, 'Y': 20}
int_to_character -- {0: '*', 1: 'A', 2: 'C', 3: 'D', 4: 'E', 5: 'F', 6: 'G', 7: 'H', 8: 'I', 9: 'K', 10: 'L', 11: 'M', 12: 'N', 13: 'P', 14: 'Q', 15: 'R', 16: 'S', 17: 'T', 18: 'V', 19: 'W', 20: 'Y'}
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
model -- VAE(
  (fc1): Linear(in_features=4998, out_features=200, bias=True)
  (fc21): Linear(in_features=200, out_features=20, bias=True)
  (fc22): Linear(in_features=200, out_features=20, bias=True)
  (fc3): Linear(in_features=20, out_features=200, bias=True)
  (fc4): Linear(in_features=200, out_features=4998, bias=True)
)
optimizer -- Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.003
    weight_decay: 0
)
train_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 103.8200. train cross entropy loss: 79.9478. train kld loss: 23.8722
time: 1.70 sec. valid loss: 37.6405. valid cross entropy loss: 27.8036, valid kld loss 9.8370
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 34.7867. train cross entropy loss: 27.1836. train kld loss: 7.6031
time: 3.62 sec. valid loss: 33.2990. valid cross entropy loss: 27.3086, valid kld loss 5.9903
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 32.3164. train cross entropy loss: 26.5442. train kld loss: 5.7722
time: 5.53 sec. valid loss: 33.1566. valid cross entropy loss: 27.8828, valid kld loss 5.2738
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 33.0161. train cross entropy loss: 26.5827. train kld loss: 6.4334
time: 7.43 sec. valid loss: 31.9060. valid cross entropy loss: 26.8776, valid kld loss 5.0284
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 30.2522. train cross entropy loss: 25.5804. train kld loss: 4.6718
time: 9.28 sec. valid loss: 30.9975. valid cross entropy loss: 27.2780, valid kld loss 3.7195
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 30.1012. train cross entropy loss: 25.6375. train kld loss: 4.4636
time: 11.16 sec. valid loss: 30.2627. valid cross entropy loss: 26.4417, valid kld loss 3.8210
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 29.7110. train cross entropy loss: 25.3080. train kld loss: 4.4030
time: 13.03 sec. valid loss: 30.8324. valid cross entropy loss: 25.4765, valid kld loss 5.3559
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 27.8999. train cross entropy loss: 24.7194. train kld loss: 3.1804
time: 14.91 sec. valid loss: 29.3890. valid cross entropy loss: 25.7565, valid kld loss 3.6325
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 26.7599. train cross entropy loss: 24.4453. train kld loss: 2.3146
time: 16.83 sec. valid loss: 27.5535. valid cross entropy loss: 25.6666, valid kld loss 1.8869
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 25.3614. train cross entropy loss: 23.9206. train kld loss: 1.4408
time: 18.72 sec. valid loss: 26.3756. valid cross entropy loss: 25.4482, valid kld loss 0.9274
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 24.5865. train cross entropy loss: 23.6031. train kld loss: 0.9835
time: 20.59 sec. valid loss: 25.9563. valid cross entropy loss: 25.2190, valid kld loss 0.7373
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 24.0949. train cross entropy loss: 23.3276. train kld loss: 0.7674
time: 22.49 sec. valid loss: 25.7367. valid cross entropy loss: 25.0651, valid kld loss 0.6716
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 23.8623. train cross entropy loss: 23.1601. train kld loss: 0.7022
time: 24.38 sec. valid loss: 25.4770. valid cross entropy loss: 24.9509, valid kld loss 0.5262
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 23.5115. train cross entropy loss: 22.8865. train kld loss: 0.6249
time: 26.29 sec. valid loss: 25.4604. valid cross entropy loss: 25.0115, valid kld loss 0.4489
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 23.3324. train cross entropy loss: 22.6603. train kld loss: 0.6721
time: 28.20 sec. valid loss: 25.4587. valid cross entropy loss: 25.0453, valid kld loss 0.4134
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 23.0524. train cross entropy loss: 22.2249. train kld loss: 0.8275
time: 30.10 sec. valid loss: 25.4118. valid cross entropy loss: 24.8823, valid kld loss 0.5294
--------------------------------------------------
--------------------------------------------------
epoch: 17. train loss: 23.1253. train cross entropy loss: 22.0742. train kld loss: 1.0511
time: 31.99 sec. valid loss: 25.6710. valid cross entropy loss: 24.9897, valid kld loss 0.6814
--------------------------------------------------
--------------------------------------------------
epoch: 18. train loss: 22.9377. train cross entropy loss: 21.6618. train kld loss: 1.2759
time: 33.86 sec. valid loss: 25.6599. valid cross entropy loss: 24.9612, valid kld loss 0.6986
--------------------------------------------------
--------------------------------------------------
epoch: 19. train loss: 22.7110. train cross entropy loss: 21.2524. train kld loss: 1.4586
time: 35.77 sec. valid loss: 25.6519. valid cross entropy loss: 24.7647, valid kld loss 0.8872
--------------------------------------------------
--------------------------------------------------
epoch: 20. train loss: 22.6972. train cross entropy loss: 20.9861. train kld loss: 1.7111
time: 37.65 sec. valid loss: 25.7132. valid cross entropy loss: 24.6883, valid kld loss 1.0248
--------------------------------------------------
--------------------------------------------------
epoch: 21. train loss: 22.4715. train cross entropy loss: 20.4216. train kld loss: 2.0500
time: 39.52 sec. valid loss: 25.7939. valid cross entropy loss: 24.7818, valid kld loss 1.0121
--------------------------------------------------
--------------------------------------------------
epoch: 22. train loss: 22.3369. train cross entropy loss: 20.0789. train kld loss: 2.2580
time: 41.38 sec. valid loss: 26.2888. valid cross entropy loss: 24.8592, valid kld loss 1.4296
--------------------------------------------------
--------------------------------------------------
epoch: 23. train loss: 22.3189. train cross entropy loss: 19.7432. train kld loss: 2.5758
time: 43.27 sec. valid loss: 26.3101. valid cross entropy loss: 24.8878, valid kld loss 1.4223
--------------------------------------------------
--------------------------------------------------
epoch: 24. train loss: 21.9292. train cross entropy loss: 19.1676. train kld loss: 2.7616
time: 45.19 sec. valid loss: 26.3845. valid cross entropy loss: 24.9437, valid kld loss 1.4408
--------------------------------------------------
--------------------------------------------------
epoch: 25. train loss: 21.7737. train cross entropy loss: 18.7640. train kld loss: 3.0097
time: 47.09 sec. valid loss: 26.2450. valid cross entropy loss: 24.6288, valid kld loss 1.6162
--------------------------------------------------
--------------------------------------------------
epoch: 26. train loss: 21.6501. train cross entropy loss: 18.3175. train kld loss: 3.3326
time: 49.04 sec. valid loss: 26.7573. valid cross entropy loss: 24.7875, valid kld loss 1.9697
--------------------------------------------------
--------------------------------------------------
epoch: 27. train loss: 21.6901. train cross entropy loss: 18.0138. train kld loss: 3.6763
time: 50.93 sec. valid loss: 27.1315. valid cross entropy loss: 24.9246, valid kld loss 2.2070
--------------------------------------------------
--------------------------------------------------
epoch: 28. train loss: 21.4457. train cross entropy loss: 17.6209. train kld loss: 3.8248
time: 52.83 sec. valid loss: 27.0056. valid cross entropy loss: 24.8909, valid kld loss 2.1147
--------------------------------------------------
--------------------------------------------------
epoch: 29. train loss: 21.4685. train cross entropy loss: 17.3385. train kld loss: 4.1300
time: 54.72 sec. valid loss: 27.1149. valid cross entropy loss: 24.9453, valid kld loss 2.1695
--------------------------------------------------
--------------------------------------------------
epoch: 30. train loss: 21.1549. train cross entropy loss: 16.8583. train kld loss: 4.2966
time: 56.59 sec. valid loss: 27.2088. valid cross entropy loss: 24.7234, valid kld loss 2.4853
--------------------------------------------------
--------------------------------------------------
epoch: 31. train loss: 20.7805. train cross entropy loss: 16.2946. train kld loss: 4.4859
time: 58.47 sec. valid loss: 27.4710. valid cross entropy loss: 25.1559, valid kld loss 2.3151
--------------------------------------------------
--------------------------------------------------
epoch: 32. train loss: 20.8000. train cross entropy loss: 16.0590. train kld loss: 4.7410
time: 60.35 sec. valid loss: 27.7150. valid cross entropy loss: 25.1344, valid kld loss 2.5806
--------------------------------------------------
--------------------------------------------------
epoch: 33. train loss: 20.5564. train cross entropy loss: 15.6116. train kld loss: 4.9448
time: 62.28 sec. valid loss: 27.8866. valid cross entropy loss: 24.8875, valid kld loss 2.9991
--------------------------------------------------
--------------------------------------------------
epoch: 34. train loss: 20.4565. train cross entropy loss: 15.2873. train kld loss: 5.1692
time: 64.18 sec. valid loss: 28.3986. valid cross entropy loss: 25.5745, valid kld loss 2.8241
--------------------------------------------------
--------------------------------------------------
epoch: 35. train loss: 20.4124. train cross entropy loss: 15.0666. train kld loss: 5.3458
time: 66.09 sec. valid loss: 28.4856. valid cross entropy loss: 25.5555, valid kld loss 2.9301
--------------------------------------------------
--------------------------------------------------
epoch: 36. train loss: 20.4307. train cross entropy loss: 14.8755. train kld loss: 5.5552
time: 68.13 sec. valid loss: 28.7033. valid cross entropy loss: 25.2584, valid kld loss 3.4449
--------------------------------------------------
--------------------------------------------------
epoch: 37. train loss: 20.5579. train cross entropy loss: 14.7949. train kld loss: 5.7630
time: 70.02 sec. valid loss: 28.7360. valid cross entropy loss: 25.3782, valid kld loss 3.3578
--------------------------------------------------
--------------------------------------------------
epoch: 38. train loss: 20.2893. train cross entropy loss: 14.4886. train kld loss: 5.8008
time: 71.88 sec. valid loss: 28.9366. valid cross entropy loss: 25.0019, valid kld loss 3.9346
--------------------------------------------------
--------------------------------------------------
epoch: 39. train loss: 19.9677. train cross entropy loss: 14.0341. train kld loss: 5.9336
time: 73.74 sec. valid loss: 29.2240. valid cross entropy loss: 26.0343, valid kld loss 3.1897
--------------------------------------------------
--------------------------------------------------
epoch: 40. train loss: 20.0628. train cross entropy loss: 13.9972. train kld loss: 6.0656
time: 75.62 sec. valid loss: 29.5578. valid cross entropy loss: 25.2468, valid kld loss 4.3110
--------------------------------------------------
--------------------------------------------------
epoch: 41. train loss: 20.0521. train cross entropy loss: 13.8129. train kld loss: 6.2392
time: 77.47 sec. valid loss: 29.1477. valid cross entropy loss: 25.5275, valid kld loss 3.6202
--------------------------------------------------
--------------------------------------------------
epoch: 42. train loss: 19.6965. train cross entropy loss: 13.3808. train kld loss: 6.3158
time: 79.29 sec. valid loss: 29.5892. valid cross entropy loss: 25.9176, valid kld loss 3.6716
--------------------------------------------------
--------------------------------------------------
epoch: 43. train loss: 19.8709. train cross entropy loss: 13.4254. train kld loss: 6.4455
time: 81.14 sec. valid loss: 29.6025. valid cross entropy loss: 25.6760, valid kld loss 3.9266
--------------------------------------------------
--------------------------------------------------
epoch: 44. train loss: 19.8738. train cross entropy loss: 13.3080. train kld loss: 6.5658
time: 83.00 sec. valid loss: 29.7002. valid cross entropy loss: 26.1139, valid kld loss 3.5864
--------------------------------------------------
--------------------------------------------------
epoch: 45. train loss: 19.6677. train cross entropy loss: 13.0824. train kld loss: 6.5853
time: 84.89 sec. valid loss: 29.7355. valid cross entropy loss: 25.6778, valid kld loss 4.0577
--------------------------------------------------
--------------------------------------------------
epoch: 46. train loss: 19.5162. train cross entropy loss: 12.7505. train kld loss: 6.7656
time: 86.72 sec. valid loss: 29.8863. valid cross entropy loss: 26.4765, valid kld loss 3.4098
--------------------------------------------------
--------------------------------------------------
epoch: 47. train loss: 19.5475. train cross entropy loss: 12.7130. train kld loss: 6.8346
time: 88.57 sec. valid loss: 30.8466. valid cross entropy loss: 27.3950, valid kld loss 3.4516
--------------------------------------------------
--------------------------------------------------
epoch: 48. train loss: 19.2723. train cross entropy loss: 12.4006. train kld loss: 6.8717
time: 90.39 sec. valid loss: 30.0790. valid cross entropy loss: 26.4189, valid kld loss 3.6600
--------------------------------------------------
--------------------------------------------------
epoch: 49. train loss: 19.1873. train cross entropy loss: 12.2555. train kld loss: 6.9318
time: 92.26 sec. valid loss: 30.5948. valid cross entropy loss: 26.8631, valid kld loss 3.7317
--------------------------------------------------
--------------------------------------------------
epoch: 50. train loss: 19.4495. train cross entropy loss: 12.2618. train kld loss: 7.1876
time: 94.13 sec. valid loss: 30.8061. valid cross entropy loss: 27.3948, valid kld loss 3.4113
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 31.1946 cross entropy loss: 27.6981. kld loss: 3.4965
