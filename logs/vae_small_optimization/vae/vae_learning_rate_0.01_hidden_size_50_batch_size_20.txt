Training vae_learning_rate_0.01_hidden_size_50_batch_size_20 
Args:
args -- {'model_type': 'vae', 'base_log': './logs/vae_small_optimization/', 'name': 'vae_learning_rate_0.01_hidden_size_50_batch_size_20', 'input': 4998, 'hidden_size': 50, 'latent_dim': 20, 'seq_length': 238, 'pseudo_count': 1, 'n_jobs': 5, 'learning_rate': 0.01, 'epochs': 50, 'batch_size': 20, 'layers': 2, 'dataset': 'gfp_amino_acid', 'num_data': 1000, 'device': device(type='cpu'), 'vocabulary': '*ACDEFGHIKLMNPQRSTVWY', 'wild_type': 'SKGEELFTGVVPILVELDGDVNGHKFSVSGEGEGDATYGKLTLKFICTTGKLPVPWPTLVTTLSYGVQCFSRYPDHMKQHDFFKSAMPEGYVQERTIFFKDDGNYKTRAEVKFEGDTLVNRIELKGIDFKEDGNILGHKLEYNYNSHNVYIMADKQKNGIKVNFKIRHNIEDGSVQLADHYQQNTPIGDGPVLLPDNHYLSTQSALSKDPNEKRDHMVLLEFVTAAGITHGMDELYK*'}
save_epochs -- 50
model_type -- vae
name -- vae_learning_rate_0.01_hidden_size_50_batch_size_20
input -- 4998
hidden_size -- 50
latent_dim -- 20
device -- cpu
learning_rate -- 0.01
epochs -- 50
all_characters -- *ACDEFGHIKLMNPQRSTVWY
seq_length -- 238
batch_size -- 20
num_characters -- 21
character_to_int -- {'*': 0, 'A': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'H': 7, 'I': 8, 'K': 9, 'L': 10, 'M': 11, 'N': 12, 'P': 13, 'Q': 14, 'R': 15, 'S': 16, 'T': 17, 'V': 18, 'W': 19, 'Y': 20}
int_to_character -- {0: '*', 1: 'A', 2: 'C', 3: 'D', 4: 'E', 5: 'F', 6: 'G', 7: 'H', 8: 'I', 9: 'K', 10: 'L', 11: 'M', 12: 'N', 13: 'P', 14: 'Q', 15: 'R', 16: 'S', 17: 'T', 18: 'V', 19: 'W', 20: 'Y'}
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
model -- VAE(
  (fc1): Linear(in_features=4998, out_features=50, bias=True)
  (fc21): Linear(in_features=50, out_features=20, bias=True)
  (fc22): Linear(in_features=50, out_features=20, bias=True)
  (fc3): Linear(in_features=20, out_features=50, bias=True)
  (fc4): Linear(in_features=50, out_features=4998, bias=True)
)
optimizer -- Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0
)
train_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 101.8780. train cross entropy loss: 82.6836. train kld loss: 19.1944
time: 0.80 sec. valid loss: 36.9865. valid cross entropy loss: 28.8314, valid kld loss 8.1551
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 31.4725. train cross entropy loss: 26.2432. train kld loss: 5.2294
time: 1.59 sec. valid loss: 31.4411. valid cross entropy loss: 27.1532, valid kld loss 4.2879
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 30.1892. train cross entropy loss: 25.8279. train kld loss: 4.3613
time: 2.33 sec. valid loss: 30.1385. valid cross entropy loss: 26.1505, valid kld loss 3.9880
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 28.5381. train cross entropy loss: 25.1633. train kld loss: 3.3748
time: 3.16 sec. valid loss: 29.2560. valid cross entropy loss: 26.1690, valid kld loss 3.0869
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 27.5960. train cross entropy loss: 24.9576. train kld loss: 2.6384
time: 3.99 sec. valid loss: 28.7193. valid cross entropy loss: 27.0333, valid kld loss 1.6861
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 27.2149. train cross entropy loss: 24.8777. train kld loss: 2.3373
time: 4.73 sec. valid loss: 27.9595. valid cross entropy loss: 26.0182, valid kld loss 1.9413
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 26.3111. train cross entropy loss: 24.6254. train kld loss: 1.6857
time: 5.66 sec. valid loss: 26.9892. valid cross entropy loss: 25.8866, valid kld loss 1.1026
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 25.9730. train cross entropy loss: 24.5549. train kld loss: 1.4180
time: 6.71 sec. valid loss: 27.3009. valid cross entropy loss: 25.4594, valid kld loss 1.8416
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 24.7082. train cross entropy loss: 24.0779. train kld loss: 0.6303
time: 7.74 sec. valid loss: 25.5092. valid cross entropy loss: 25.2781, valid kld loss 0.2311
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 24.1319. train cross entropy loss: 23.9338. train kld loss: 0.1981
time: 8.63 sec. valid loss: 25.2533. valid cross entropy loss: 25.1792, valid kld loss 0.0741
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 23.7940. train cross entropy loss: 23.7148. train kld loss: 0.0793
time: 9.47 sec. valid loss: 25.2117. valid cross entropy loss: 25.1529, valid kld loss 0.0588
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 23.8264. train cross entropy loss: 23.7457. train kld loss: 0.0807
time: 10.61 sec. valid loss: 25.1793. valid cross entropy loss: 25.1305, valid kld loss 0.0488
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 23.7558. train cross entropy loss: 23.6689. train kld loss: 0.0869
time: 11.63 sec. valid loss: 25.0338. valid cross entropy loss: 24.9766, valid kld loss 0.0572
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 23.6731. train cross entropy loss: 23.5711. train kld loss: 0.1020
time: 12.71 sec. valid loss: 25.1088. valid cross entropy loss: 25.0462, valid kld loss 0.0626
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 23.6648. train cross entropy loss: 23.5270. train kld loss: 0.1378
time: 13.67 sec. valid loss: 25.1023. valid cross entropy loss: 25.0350, valid kld loss 0.0673
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 23.6654. train cross entropy loss: 23.5285. train kld loss: 0.1368
time: 14.53 sec. valid loss: 25.0560. valid cross entropy loss: 24.9758, valid kld loss 0.0802
--------------------------------------------------
--------------------------------------------------
epoch: 17. train loss: 23.6177. train cross entropy loss: 23.4455. train kld loss: 0.1723
time: 15.39 sec. valid loss: 25.2157. valid cross entropy loss: 25.1270, valid kld loss 0.0888
--------------------------------------------------
--------------------------------------------------
epoch: 18. train loss: 23.6052. train cross entropy loss: 23.4111. train kld loss: 0.1940
time: 16.36 sec. valid loss: 25.1027. valid cross entropy loss: 24.9931, valid kld loss 0.1096
--------------------------------------------------
--------------------------------------------------
epoch: 19. train loss: 23.5978. train cross entropy loss: 23.3314. train kld loss: 0.2664
time: 17.18 sec. valid loss: 25.1510. valid cross entropy loss: 25.0179, valid kld loss 0.1330
--------------------------------------------------
--------------------------------------------------
epoch: 20. train loss: 23.5236. train cross entropy loss: 23.2733. train kld loss: 0.2503
time: 18.40 sec. valid loss: 25.0331. valid cross entropy loss: 24.9107, valid kld loss 0.1224
--------------------------------------------------
--------------------------------------------------
epoch: 21. train loss: 23.4436. train cross entropy loss: 23.1641. train kld loss: 0.2795
time: 19.47 sec. valid loss: 25.1290. valid cross entropy loss: 24.9770, valid kld loss 0.1521
--------------------------------------------------
--------------------------------------------------
epoch: 22. train loss: 23.3968. train cross entropy loss: 23.0562. train kld loss: 0.3406
time: 20.41 sec. valid loss: 25.0835. valid cross entropy loss: 24.9229, valid kld loss 0.1606
--------------------------------------------------
--------------------------------------------------
epoch: 23. train loss: 23.3778. train cross entropy loss: 22.9904. train kld loss: 0.3874
time: 21.42 sec. valid loss: 25.3065. valid cross entropy loss: 24.9805, valid kld loss 0.3260
--------------------------------------------------
--------------------------------------------------
epoch: 24. train loss: 23.4033. train cross entropy loss: 22.9951. train kld loss: 0.4082
time: 22.69 sec. valid loss: 25.1335. valid cross entropy loss: 24.9321, valid kld loss 0.2014
--------------------------------------------------
--------------------------------------------------
epoch: 25. train loss: 23.3459. train cross entropy loss: 22.8753. train kld loss: 0.4706
time: 23.74 sec. valid loss: 25.2327. valid cross entropy loss: 25.0041, valid kld loss 0.2286
--------------------------------------------------
--------------------------------------------------
epoch: 26. train loss: 23.3243. train cross entropy loss: 22.8331. train kld loss: 0.4912
time: 24.84 sec. valid loss: 25.2832. valid cross entropy loss: 25.0064, valid kld loss 0.2768
--------------------------------------------------
--------------------------------------------------
epoch: 27. train loss: 23.3394. train cross entropy loss: 22.7660. train kld loss: 0.5734
time: 26.00 sec. valid loss: 25.1772. valid cross entropy loss: 24.8841, valid kld loss 0.2931
--------------------------------------------------
--------------------------------------------------
epoch: 28. train loss: 23.3431. train cross entropy loss: 22.6997. train kld loss: 0.6434
time: 26.90 sec. valid loss: 25.4525. valid cross entropy loss: 25.0079, valid kld loss 0.4446
--------------------------------------------------
--------------------------------------------------
epoch: 29. train loss: 23.3191. train cross entropy loss: 22.6843. train kld loss: 0.6348
time: 27.73 sec. valid loss: 25.2442. valid cross entropy loss: 24.9498, valid kld loss 0.2944
--------------------------------------------------
--------------------------------------------------
epoch: 30. train loss: 23.1695. train cross entropy loss: 22.4544. train kld loss: 0.7151
time: 28.56 sec. valid loss: 25.2891. valid cross entropy loss: 24.9398, valid kld loss 0.3493
--------------------------------------------------
--------------------------------------------------
epoch: 31. train loss: 23.2298. train cross entropy loss: 22.4327. train kld loss: 0.7970
time: 29.37 sec. valid loss: 25.4130. valid cross entropy loss: 25.0205, valid kld loss 0.3925
--------------------------------------------------
--------------------------------------------------
epoch: 32. train loss: 23.0897. train cross entropy loss: 22.3294. train kld loss: 0.7602
time: 30.34 sec. valid loss: 25.6071. valid cross entropy loss: 25.1133, valid kld loss 0.4938
--------------------------------------------------
--------------------------------------------------
epoch: 33. train loss: 23.1148. train cross entropy loss: 22.2743. train kld loss: 0.8405
time: 31.23 sec. valid loss: 25.4290. valid cross entropy loss: 25.0043, valid kld loss 0.4247
--------------------------------------------------
--------------------------------------------------
epoch: 34. train loss: 23.2985. train cross entropy loss: 22.3700. train kld loss: 0.9285
time: 32.09 sec. valid loss: 25.6845. valid cross entropy loss: 25.1674, valid kld loss 0.5171
--------------------------------------------------
--------------------------------------------------
epoch: 35. train loss: 23.1090. train cross entropy loss: 22.1932. train kld loss: 0.9158
time: 33.00 sec. valid loss: 25.6597. valid cross entropy loss: 25.1889, valid kld loss 0.4708
--------------------------------------------------
--------------------------------------------------
epoch: 36. train loss: 23.1328. train cross entropy loss: 22.1504. train kld loss: 0.9824
time: 33.96 sec. valid loss: 25.5856. valid cross entropy loss: 25.0954, valid kld loss 0.4902
--------------------------------------------------
--------------------------------------------------
epoch: 37. train loss: 23.1240. train cross entropy loss: 22.0862. train kld loss: 1.0379
time: 34.78 sec. valid loss: 25.4780. valid cross entropy loss: 24.9271, valid kld loss 0.5509
--------------------------------------------------
--------------------------------------------------
epoch: 38. train loss: 23.1261. train cross entropy loss: 22.0784. train kld loss: 1.0477
time: 35.64 sec. valid loss: 25.5276. valid cross entropy loss: 24.7936, valid kld loss 0.7339
--------------------------------------------------
--------------------------------------------------
epoch: 39. train loss: 22.9822. train cross entropy loss: 21.8314. train kld loss: 1.1507
time: 36.59 sec. valid loss: 25.5035. valid cross entropy loss: 24.7816, valid kld loss 0.7219
--------------------------------------------------
--------------------------------------------------
epoch: 40. train loss: 22.9089. train cross entropy loss: 21.6837. train kld loss: 1.2252
time: 37.40 sec. valid loss: 25.7953. valid cross entropy loss: 24.9406, valid kld loss 0.8548
--------------------------------------------------
--------------------------------------------------
epoch: 41. train loss: 22.9264. train cross entropy loss: 21.7138. train kld loss: 1.2126
time: 38.19 sec. valid loss: 25.7667. valid cross entropy loss: 25.0583, valid kld loss 0.7084
--------------------------------------------------
--------------------------------------------------
epoch: 42. train loss: 22.8997. train cross entropy loss: 21.6607. train kld loss: 1.2391
time: 39.21 sec. valid loss: 25.6500. valid cross entropy loss: 25.0028, valid kld loss 0.6472
--------------------------------------------------
--------------------------------------------------
epoch: 43. train loss: 22.8588. train cross entropy loss: 21.5264. train kld loss: 1.3324
time: 40.47 sec. valid loss: 25.7488. valid cross entropy loss: 25.0434, valid kld loss 0.7054
--------------------------------------------------
--------------------------------------------------
epoch: 44. train loss: 22.7262. train cross entropy loss: 21.3557. train kld loss: 1.3705
time: 41.47 sec. valid loss: 26.0629. valid cross entropy loss: 25.4767, valid kld loss 0.5862
--------------------------------------------------
--------------------------------------------------
epoch: 45. train loss: 22.8649. train cross entropy loss: 21.4522. train kld loss: 1.4128
time: 42.41 sec. valid loss: 26.0330. valid cross entropy loss: 25.0411, valid kld loss 0.9919
--------------------------------------------------
--------------------------------------------------
epoch: 46. train loss: 22.8970. train cross entropy loss: 21.4560. train kld loss: 1.4410
time: 43.23 sec. valid loss: 25.9365. valid cross entropy loss: 25.0721, valid kld loss 0.8644
--------------------------------------------------
--------------------------------------------------
epoch: 47. train loss: 22.9009. train cross entropy loss: 21.4121. train kld loss: 1.4888
time: 44.08 sec. valid loss: 26.2319. valid cross entropy loss: 25.0780, valid kld loss 1.1540
--------------------------------------------------
--------------------------------------------------
epoch: 48. train loss: 22.8607. train cross entropy loss: 21.3393. train kld loss: 1.5214
time: 44.99 sec. valid loss: 25.8803. valid cross entropy loss: 24.9643, valid kld loss 0.9160
--------------------------------------------------
--------------------------------------------------
epoch: 49. train loss: 22.6409. train cross entropy loss: 21.1925. train kld loss: 1.4483
time: 46.07 sec. valid loss: 26.2684. valid cross entropy loss: 25.4216, valid kld loss 0.8468
--------------------------------------------------
--------------------------------------------------
epoch: 50. train loss: 22.8343. train cross entropy loss: 21.2532. train kld loss: 1.5810
time: 47.17 sec. valid loss: 26.3443. valid cross entropy loss: 25.2638, valid kld loss 1.0805
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 26.8749 cross entropy loss: 25.7896. kld loss: 1.0853
