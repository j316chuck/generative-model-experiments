training vae model.
number of parameters -- 172840.
model args:
**************************************************
save_epochs -- 50
model_type -- vae
base_log -- logs/synthetic_unimodal_data_length_20_uniform/vae
name -- vae_default_medium
input -- 400
hidden_size -- 200
latent_dim -- 20
seq_length -- 20
pseudo_count -- 1
n_jobs -- 1
device -- cpu
learning_rate -- 0.001
epochs -- 100
batch_size -- 10
layers -- 1
dataset -- synthetic_unimodal_data_length_20_uniform
num_data -- 1000
all_characters -- ACDEFGHIKLMNPQRSTVWY
early_stopping -- <early_stopping.EarlyStopping object at 0x11b6e4c88>
patience -- 10
num_characters -- 20
indexes -- [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
train_loss_history -- []
valid_loss_history -- []
train_recon_loss_history -- []
train_kld_loss_history -- []
valid_recon_loss_history -- []
valid_kld_loss_history -- []
**************************************************
training model on train and validation datasets...
--------------------------------------------------
epoch: 1. train loss: 37.7608. train cross entropy loss: 34.9232. train kld loss: 2.8375
time: 1.12 sec. valid loss: 31.8047. valid cross entropy loss: 29.6186, valid kld loss 2.1860
--------------------------------------------------
--------------------------------------------------
epoch: 2. train loss: 30.7352. train cross entropy loss: 28.7876. train kld loss: 1.9476
time: 2.21 sec. valid loss: 30.4834. valid cross entropy loss: 28.7037, valid kld loss 1.7797
--------------------------------------------------
--------------------------------------------------
epoch: 3. train loss: 29.3661. train cross entropy loss: 28.0379. train kld loss: 1.3282
time: 3.29 sec. valid loss: 28.8057. valid cross entropy loss: 27.9624, valid kld loss 0.8433
--------------------------------------------------
--------------------------------------------------
epoch: 4. train loss: 28.0647. train cross entropy loss: 27.4128. train kld loss: 0.6519
time: 4.37 sec. valid loss: 27.9335. valid cross entropy loss: 27.5202, valid kld loss 0.4133
--------------------------------------------------
--------------------------------------------------
epoch: 5. train loss: 27.5452. train cross entropy loss: 27.0596. train kld loss: 0.4856
time: 5.47 sec. valid loss: 27.9556. valid cross entropy loss: 27.4838, valid kld loss 0.4718
--------------------------------------------------
--------------------------------------------------
epoch: 6. train loss: 27.4533. train cross entropy loss: 26.8383. train kld loss: 0.6150
time: 6.54 sec. valid loss: 27.9176. valid cross entropy loss: 27.3823, valid kld loss 0.5354
--------------------------------------------------
--------------------------------------------------
epoch: 7. train loss: 27.4062. train cross entropy loss: 26.6560. train kld loss: 0.7502
time: 7.65 sec. valid loss: 27.9196. valid cross entropy loss: 27.2469, valid kld loss 0.6727
--------------------------------------------------
--------------------------------------------------
epoch: 8. train loss: 27.3269. train cross entropy loss: 26.3774. train kld loss: 0.9495
time: 8.73 sec. valid loss: 27.9568. valid cross entropy loss: 27.1564, valid kld loss 0.8005
--------------------------------------------------
--------------------------------------------------
epoch: 9. train loss: 27.2570. train cross entropy loss: 26.1218. train kld loss: 1.1353
time: 9.77 sec. valid loss: 27.9197. valid cross entropy loss: 27.0380, valid kld loss 0.8816
--------------------------------------------------
--------------------------------------------------
epoch: 10. train loss: 27.1290. train cross entropy loss: 25.8542. train kld loss: 1.2748
time: 10.87 sec. valid loss: 27.9891. valid cross entropy loss: 26.9839, valid kld loss 1.0053
--------------------------------------------------
--------------------------------------------------
epoch: 11. train loss: 27.0488. train cross entropy loss: 25.5016. train kld loss: 1.5472
time: 11.89 sec. valid loss: 28.0278. valid cross entropy loss: 26.8201, valid kld loss 1.2078
--------------------------------------------------
--------------------------------------------------
epoch: 12. train loss: 26.9365. train cross entropy loss: 25.1725. train kld loss: 1.7640
time: 12.96 sec. valid loss: 28.1150. valid cross entropy loss: 26.7932, valid kld loss 1.3217
--------------------------------------------------
--------------------------------------------------
epoch: 13. train loss: 26.8809. train cross entropy loss: 24.8803. train kld loss: 2.0007
time: 14.01 sec. valid loss: 28.0755. valid cross entropy loss: 26.5816, valid kld loss 1.4939
--------------------------------------------------
--------------------------------------------------
epoch: 14. train loss: 26.8229. train cross entropy loss: 24.5632. train kld loss: 2.2597
time: 15.11 sec. valid loss: 28.1462. valid cross entropy loss: 26.5186, valid kld loss 1.6275
--------------------------------------------------
--------------------------------------------------
epoch: 15. train loss: 26.8359. train cross entropy loss: 24.2951. train kld loss: 2.5409
time: 16.18 sec. valid loss: 28.3153. valid cross entropy loss: 26.5213, valid kld loss 1.7941
--------------------------------------------------
--------------------------------------------------
epoch: 16. train loss: 26.5022. train cross entropy loss: 23.7914. train kld loss: 2.7108
time: 17.24 sec. valid loss: 28.3560. valid cross entropy loss: 26.4135, valid kld loss 1.9425
--------------------------------------------------
--------------------------------------------------
early stopped at epoch 16
loading model from epoch 6
--------------------------------------------------
**************************************************
evaluating model on test dataset:
total loss: 27.6909 cross entropy loss: 27.1522. kld loss: 0.5387
**************************************************
average mismatches per sample: 5.5800
**************************************************
{'dataset': 'synthetic_unimodal_data_length_20_uniform', 'model_type': 'vae', 'name': 'vae_default_medium', 'exit_code': 0, 'train_score': (27.233060836791992, 26.575927734375, 0.6571336984634399), 'valid_score': (27.93434715270996, 27.39897918701172, 0.5353597402572632), 'test_score': (27.69091796875, 27.15219497680664, 0.5387199521064758), 'average_mismatches': 5.58, 'num_params': 172840, 'total_time': 20.82635498046875}
